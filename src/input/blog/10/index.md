title: Открыт доступ к очереди проигрывания
date: 2011-04-20 21:15
labels: blog, tech
author: hex@umonkey.net (umonkey)
---
Непосредственно управлять тем, что звучит на «Тоже мне радио» прямо сейчас,
раньше могли только администраторы сервера.  Теперь такая возможность есть у
всех слушателей, хотя и с ограничениями, описанными в конце этой заметки.

Новость заключается в том, что теперь любой слушатель может зарядить дорожку для
проигрывания.  Дорожка добавляется в конец очереди и прозвучит как только
закончит играть то, что играло на момент выполнения команды и вся остальная
очередь (если кто-то уже что-то добавил).

Чтобы воспользоваться этой командой нужно уметь разговаривать с нашим роботом с
помощью [джаббера](/voting/).  Для добавления дорожки в очередь используется
команда queue, которой нужно указать идентификатор дорожки.  Узнать его можно
с помощью команды find.  Обычно это выглядит так:

    > find gorky
    Found these tracks:
    «Moscow Calling» by Gorky Park — #5012 ⚖3.00 ♺19
    «Stare» by Gorky Park — #5066 ⚖2.25 ♺18
    «Stranger» by Gorky Park — #4975 ⚖2.00 ♺36
    > queue 5066
    Current queue:
    «Stare» by Gorky Park — #5066 ⚖2.25 ♺18

Если нужно поставить в очередь не коткретную дорожку, а исполнителя или дорожку,
содержащую определённую последовательность в названии, можно обойтись без
команды find:

    > queue porn
    Current queue:
    sad robot» by pornophonique — #4368 ⚖3.25 ♺180

У команд find и queue есть одна особенность: они сортируют результат по убыванию
рейтинга.  Команда «queue gorky» добавит в очередь наиболее рейтинговую дорожку
из тех, что содержат «gorky» в названии.  Если хочется добавить не самую
рейтинговую, а случайную дорожку, следует после команды указать ключ «-r»:

    > queue -r gorky

Можно также искать по меткам:

    > find @sad
    «Генералы песчаных карьеров» by Несчастный Случай — #4566 ⚖2.25 ♺104
    «Кукушка» by Земфира — #4086 ⚖1.75 ♺133

Команды доступны всем слушателям.  Ограничение, упомянутое в начале, заключается
в том, что, в отличие от администраторов, рядовые пользователи могут добавлять в
очередь только по одной дорожке.  Добавить следующую можно только когда
прозвучала предыдущая.  Это сделано для того, чтобы не ссорить пользователей
между собой и исключить злоупотребление.
